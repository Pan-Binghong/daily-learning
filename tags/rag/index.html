<!doctype html><html lang=en dir=auto data-theme=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>RAG | Pan Binghong's Tech Blog</title><meta name=keywords content><meta name=description content="è®°å½•æŠ€æœ¯æˆé•¿çš„æ¯ä¸€æ­¥ - AIã€åç«¯ã€DevOps å­¦ä¹ ç¬”è®°"><meta name=author content="Pan Binghong"><link rel=canonical href=https://Pan-Binghong.github.io/daily-learning/tags/rag/><link crossorigin=anonymous href=/daily-learning/assets/css/stylesheet.8c4274f6592e00e67f9d9e38f6a29695c6a6ce5eded446ed371ff6565dbb189f.css integrity="sha256-jEJ09lkuAOZ/nZ449qKWlcamzl7e1EbtNx/2Vl27GJ8=" rel="preload stylesheet" as=style><link rel=icon href=https://Pan-Binghong.github.io/daily-learning/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://Pan-Binghong.github.io/daily-learning/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://Pan-Binghong.github.io/daily-learning/favicon-32x32.png><link rel=apple-touch-icon href=https://Pan-Binghong.github.io/daily-learning/apple-touch-icon.png><link rel=mask-icon href=https://Pan-Binghong.github.io/daily-learning/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate type=application/rss+xml href=https://Pan-Binghong.github.io/daily-learning/tags/rag/index.xml title=rss><link rel=alternate hreflang=en href=https://Pan-Binghong.github.io/daily-learning/tags/rag/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51);color-scheme:dark}.list{background:var(--theme)}.toc{background:var(--entry)}}@media(prefers-color-scheme:light){.list::-webkit-scrollbar-thumb{border-color:var(--code-bg)}}</style></noscript><script>localStorage.getItem("pref-theme")==="dark"?document.querySelector("html").dataset.theme="dark":localStorage.getItem("pref-theme")==="light"?document.querySelector("html").dataset.theme="light":window.matchMedia("(prefers-color-scheme: dark)").matches?document.querySelector("html").dataset.theme="dark":document.querySelector("html").dataset.theme="light"</script><link rel=stylesheet href=https://unpkg.com/github-calendar@latest/dist/github-calendar-responsive.css><style>.reading-progress-bar{position:fixed;top:0;left:0;height:3px;background:linear-gradient(90deg,var(--primary),#00d4ff);z-index:9999;transition:width .1s ease;box-shadow:0 0 10px rgba(0,212,255,.5)}</style><script>document.addEventListener("DOMContentLoaded",function(){document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();const t=document.querySelector(this.getAttribute("href"));t&&t.scrollIntoView({behavior:"smooth",block:"start"})})})})</script><meta property="og:url" content="https://Pan-Binghong.github.io/daily-learning/tags/rag/"><meta property="og:site_name" content="Pan Binghong's Tech Blog"><meta property="og:title" content="RAG"><meta property="og:description" content="è®°å½•æŠ€æœ¯æˆé•¿çš„æ¯ä¸€æ­¥ - AIã€åç«¯ã€DevOps å­¦ä¹ ç¬”è®°"><meta property="og:locale" content="zh-CN"><meta property="og:type" content="website"><meta name=twitter:card content="summary"><meta name=twitter:title content="RAG"><meta name=twitter:description content="è®°å½•æŠ€æœ¯æˆé•¿çš„æ¯ä¸€æ­¥ - AIã€åç«¯ã€DevOps å­¦ä¹ ç¬”è®°"></head><body class=list id=top><header class=header><nav class=nav><div class=logo><a href=https://Pan-Binghong.github.io/daily-learning/ accesskey=h title="Pan Binghong's Tech Blog (Alt + H)">Pan Binghong's Tech Blog</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)" aria-label="Toggle theme">
<svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg>
<svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://Pan-Binghong.github.io/daily-learning/ title="ğŸ  é¦–é¡µ"><span>ğŸ  é¦–é¡µ</span></a></li><li><a href=https://Pan-Binghong.github.io/daily-learning/ai/ title="ğŸ¤– AI"><span>ğŸ¤– AI</span></a></li><li><a href=https://Pan-Binghong.github.io/daily-learning/knowledge/ title="ğŸ“š çŸ¥è¯†åº“"><span>ğŸ“š çŸ¥è¯†åº“</span></a></li><li><a href=https://Pan-Binghong.github.io/daily-learning/backend/ title="âš™ï¸ åç«¯"><span>âš™ï¸ åç«¯</span></a></li><li><a href=https://Pan-Binghong.github.io/daily-learning/devops/ title="ğŸ”§ DevOps"><span>ğŸ”§ DevOps</span></a></li><li><a href=https://Pan-Binghong.github.io/daily-learning/other/ title="ğŸ“ å…¶ä»–"><span>ğŸ“ å…¶ä»–</span></a></li><li><a href=https://Pan-Binghong.github.io/daily-learning/search/ title="ğŸ” æœç´¢"><span>ğŸ” æœç´¢</span></a></li><li><a href=https://Pan-Binghong.github.io/daily-learning/tags/ title="ğŸ·ï¸ æ ‡ç­¾"><span>ğŸ·ï¸ æ ‡ç­¾</span></a></li><li><a href=https://Pan-Binghong.github.io/daily-learning/archives/ title="ğŸ“‚ å½’æ¡£"><span>ğŸ“‚ å½’æ¡£</span></a></li><li><a href=https://Pan-Binghong.github.io/daily-learning/about/ title="ğŸ‘¤ å…³äº"><span>ğŸ‘¤ å…³äº</span></a></li></ul></nav></header><main class=main><header class=page-header><div class=breadcrumbs><a href=https://Pan-Binghong.github.io/daily-learning/>Home</a>&nbsp;Â»&nbsp;<a href=https://Pan-Binghong.github.io/daily-learning/tags/>Tags</a></div><h1>RAG
<a href=/daily-learning/tags/rag/index.xml title=RSS aria-label=RSS><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" height="23"><path d="M4 11a9 9 0 019 9"/><path d="M4 4a16 16 0 0116 16"/><circle cx="5" cy="19" r="1"/></svg></a></h1></header><article class="post-entry tag-entry"><header class=entry-header><h2 class=entry-hint-parent>è®ºæ–‡ç²¾è¯»_å¯»æ‰¾RAGæœ€ä¼˜ç­–ç•¥</h2></header><div class=entry-content><p>ğŸ’¡ è¿™ç¯‡çœŸçš„å…¨æ˜¯å¹²è´§â€¦è®ºæ–‡çš„å®éªŒéƒ¨åˆ†ï¼Œæˆ‘å°±ä¸å†™äº†ã€‚çœ‹çœ‹å°±è¡Œã€‚
ç›¸å…³å·¥ä½œ|æŸ¥è¯¢æ£€ç´¢å±‚é¢ ç¡®ä¿å¤§å‹è¯­è¨€æ¨¡å‹ï¼ˆLLMsï¼‰å¦‚ChatGPTå’ŒLLaMAç”Ÿæˆçš„å›åº”å‡†ç¡®æ€§è‡³å…³é‡è¦ã€‚ç„¶è€Œï¼Œç®€å•åœ°å¢åŠ æ¨¡å‹å¤§å°å¹¶ä¸èƒ½ä»æ ¹æœ¬ä¸Šè§£å†³â€œå¹»è§‰â€é—®é¢˜ï¼Œè¿™åœ¨çŸ¥è¯†å¯†é›†å‹ä»»åŠ¡å’Œä¸“ä¸šé¢†åŸŸå°¤ä¸ºæ˜æ˜¾ã€‚æ£€ç´¢å¢å¼ºç”Ÿæˆï¼ˆRAGï¼‰é€šè¿‡ä»å¤–éƒ¨çŸ¥è¯†åº“æ£€ç´¢ç›¸å…³æ–‡æ¡£ï¼Œä¸ºLLMsæä¾›å‡†ç¡®ã€å®æ—¶ã€é¢†åŸŸç‰¹å®šçš„ä¸Šä¸‹æ–‡ï¼Œä»¥è§£å†³è¿™äº›æŒ‘æˆ˜ã€‚å…ˆå‰çš„å·¥ä½œé€šè¿‡æŸ¥è¯¢å’Œæ£€ç´¢è½¬æ¢ä¼˜åŒ–äº†RAGæµç¨‹ï¼Œæé«˜äº†æ£€ç´¢å™¨çš„æ€§èƒ½ï¼Œå¹¶å¯¹æ£€ç´¢å™¨å’Œç”Ÿæˆå™¨è¿›è¡Œäº†å¾®è°ƒã€‚è¿™äº›ä¼˜åŒ–æ”¹å–„äº†è¾“å…¥æŸ¥è¯¢ã€æ£€ç´¢æœºåˆ¶ä¸ç”Ÿæˆè¿‡ç¨‹ä¹‹é—´çš„äº’åŠ¨ï¼Œç¡®ä¿äº†å›åº”çš„å‡†ç¡®æ€§å’Œç›¸å…³æ€§ã€‚
RAGå·¥ä½œæµ åœ¨æœ¬èŠ‚ä¸­ï¼Œæˆ‘ä»¬å°†è¯¦ç»†ä»‹ç»RAGå·¥ä½œæµç¨‹çš„å„ä¸ªç»„ä»¶ã€‚é’ˆå¯¹æ¯ä¸ªæ¨¡å—ï¼Œæˆ‘ä»¬å›é¡¾å¸¸ç”¨çš„æ–¹æ³•ï¼Œå¹¶ä¸ºæˆ‘ä»¬çš„æœ€ç»ˆæµç¨‹é€‰æ‹©äº†é»˜è®¤å’Œå¤‡é€‰æ–¹æ³•ã€‚
æŸ¥è¯¢åˆ†ç±» å¹¶éæ‰€æœ‰çš„æŸ¥è¯¢éƒ½éœ€è¦é€šè¿‡æ£€ç´¢å¢å¼ºï¼Œå› ä¸ºå¤§å‹è¯­è¨€æ¨¡å‹ï¼ˆLLMsï¼‰æœ¬èº«å°±å…·å¤‡ä¸€å®šçš„å¤„ç†èƒ½åŠ›ã€‚å°½ç®¡æ£€ç´¢å¢å¼ºç”Ÿæˆï¼ˆRAGï¼‰å¯ä»¥æé«˜ä¿¡æ¯çš„å‡†ç¡®æ€§å¹¶å‡å°‘è™šæ„å†…å®¹ï¼Œä½†é¢‘ç¹çš„æ£€ç´¢å¯èƒ½ä¼šå¢åŠ å“åº”æ—¶é—´ã€‚å› æ­¤ï¼Œæˆ‘ä»¬é¦–å…ˆé€šè¿‡å¯¹æŸ¥è¯¢è¿›è¡Œåˆ†ç±»æ¥ç¡®å®šæ˜¯å¦éœ€è¦æ£€ç´¢ã€‚éœ€è¦æ£€ç´¢çš„æŸ¥è¯¢ä¼šç»è¿‡RAGæ¨¡å—å¤„ç†ï¼›å…¶ä»–åˆ™ç›´æ¥ç”±LLMså¤„ç†ã€‚é€šå¸¸ï¼Œåœ¨éœ€è¦è¶…å‡ºæ¨¡å‹å‚æ•°èŒƒå›´çš„çŸ¥è¯†æ—¶æ¨èä½¿ç”¨æ£€ç´¢ã€‚ç„¶è€Œï¼Œæ£€ç´¢çš„å¿…è¦æ€§æ ¹æ®ä»»åŠ¡çš„ä¸åŒè€Œæœ‰æ‰€å˜åŒ–ã€‚ä¾‹å¦‚ï¼Œä¸€ä¸ªè®­ç»ƒè‡³2023å¹´çš„LLMå¯ä»¥å¤„ç†â€œSoraæ˜¯ç”±OpenAIå¼€å‘çš„â€è¿™ä¸€ç¿»è¯‘è¯·æ±‚è€Œæ— éœ€æ£€ç´¢ã€‚ç›¸åï¼Œå¯¹äºåŒä¸€ä¸»é¢˜çš„ä»‹ç»è¯·æ±‚åˆ™éœ€è¦æ£€ç´¢æ¥æä¾›ç›¸å…³ä¿¡æ¯ã€‚
å› æ­¤ï¼Œæˆ‘ä»¬å»ºè®®æŒ‰ç±»å‹å¯¹ä»»åŠ¡è¿›è¡Œåˆ†ç±»ï¼Œä»¥ç¡®å®šæŸ¥è¯¢æ˜¯å¦éœ€è¦æ£€ç´¢ã€‚å¯¹äºå®Œå…¨åŸºäºç”¨æˆ·æä¾›ä¿¡æ¯çš„ä»»åŠ¡ï¼Œæˆ‘ä»¬æ ‡è®°ä¸ºâ€œå……åˆ†â€ï¼Œä¸éœ€è¦æ£€ç´¢ï¼›å¦åˆ™ï¼Œæˆ‘ä»¬æ ‡è®°ä¸ºâ€œä¸è¶³â€ï¼Œå¯èƒ½éœ€è¦æ£€ç´¢ã€‚æˆ‘ä»¬è®­ç»ƒäº†ä¸€ä¸ªåˆ†ç±»å™¨æ¥è‡ªåŠ¨åŒ–è¿™ä¸€å†³ç­–è¿‡ç¨‹ã€‚
Chunking å°†æ–‡æ¡£åˆ†å—æˆæ›´å°çš„æ®µè½å¯¹äºæé«˜æ£€ç´¢çš„å‡†ç¡®æ€§å’Œé¿å…åœ¨å¤§å‹è¯­è¨€æ¨¡å‹ï¼ˆLLMsï¼‰ä¸­å‡ºç°é•¿åº¦é—®é¢˜è‡³å…³é‡è¦ã€‚è¿™ä¸ªè¿‡ç¨‹å¯ä»¥åœ¨ä¸åŒçš„ç²’åº¦çº§åˆ«ä¸Šåº”ç”¨ï¼Œæ¯”å¦‚ä»¤ç‰Œï¼ˆtokenï¼‰ã€å¥å­å’Œè¯­ä¹‰çº§åˆ«ã€‚
ä»¤ç‰Œçº§åˆ«çš„åˆ†å—å¾ˆç›´æ¥ï¼Œä½†å¯èƒ½ä¼šåˆ†å‰²å¥å­ï¼Œå½±å“æ£€ç´¢è´¨é‡ã€‚ è¯­ä¹‰çº§åˆ«çš„åˆ†å—åˆ©ç”¨å¤§å‹è¯­è¨€æ¨¡å‹æ¥ç¡®å®šåˆ†å‰²ç‚¹ï¼Œèƒ½ä¿æŒä¸Šä¸‹æ–‡ä¸å˜ï¼Œä½†æ˜¯è€—æ—¶ã€‚ å¥å­çº§åˆ«çš„åˆ†å—åœ¨ä¿ç•™æ–‡æœ¬è¯­ä¹‰çš„åŒæ—¶ï¼Œå¹³è¡¡äº†ç®€å•æ€§å’Œæ•ˆç‡ã€‚ åœ¨è¿™é¡¹ç ”ç©¶ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨å¥å­çº§åˆ«çš„åˆ†å—ï¼Œå¹³è¡¡äº†ç®€å•æ€§å’Œè¯­ä¹‰ä¿ç•™ã€‚æˆ‘ä»¬ä»å››ä¸ªç»´åº¦è€ƒå¯Ÿäº†åˆ†å—æ–¹æ³•ã€‚ å‘é‡æ•°æ®åº“å­˜å‚¨ç€å¸¦æœ‰å…ƒæ•°æ®çš„åµŒå…¥å‘é‡ï¼Œé€šè¿‡å„ç§ç´¢å¼•å’Œè¿‘ä¼¼æœ€è¿‘é‚»ï¼ˆANNï¼‰æ–¹æ³•ï¼Œèƒ½å¤Ÿé«˜æ•ˆåœ°æ£€ç´¢ä¸æŸ¥è¯¢ç›¸å…³çš„æ–‡æ¡£ã€‚ä¸ºäº†ä¸ºæˆ‘ä»¬çš„ç ”ç©¶é€‰æ‹©ä¸€ä¸ªåˆé€‚çš„å‘é‡æ•°æ®åº“ï¼Œæˆ‘ä»¬åŸºäºå››ä¸ªå…³é”®æ ‡å‡†å¯¹å‡ ä¸ªé€‰é¡¹è¿›è¡Œäº†è¯„ä¼°ï¼šå¤šç§ç´¢å¼•ç±»å‹ã€æ”¯æŒåäº¿çº§åˆ«çš„å‘é‡ã€æ··åˆæœç´¢ä»¥åŠäº‘åŸç”Ÿèƒ½åŠ›ã€‚è¿™äº›æ ‡å‡†å› å…¶å¯¹äºçµæ´»æ€§ã€å¯æ‰©å±•æ€§ä»¥åŠåœ¨ç°ä»£äº‘åŸºç¡€è®¾æ–½ä¸­éƒ¨ç½²çš„ä¾¿æ·æ€§çš„å½±å“è€Œè¢«é€‰ä¸­ã€‚å¤šç§ç´¢å¼•ç±»å‹æä¾›äº†åŸºäºä¸åŒæ•°æ®ç‰¹æ€§å’Œç”¨ä¾‹ä¼˜åŒ–æœç´¢çš„çµæ´»æ€§ã€‚åäº¿çº§åˆ«çš„å‘é‡æ”¯æŒå¯¹äºå¤„ç†LLMåº”ç”¨ä¸­çš„å¤§å‹æ•°æ®é›†è‡³å…³é‡è¦ã€‚æ··åˆæœç´¢å°†å‘é‡æœç´¢ä¸ä¼ ç»Ÿå…³é”®è¯æœç´¢ç»“åˆèµ·æ¥ï¼Œæé«˜äº†æ£€ç´¢å‡†ç¡®æ€§ã€‚æœ€åï¼Œäº‘åŸç”Ÿèƒ½åŠ›ç¡®ä¿äº†åœ¨äº‘ç¯å¢ƒä¸­çš„æ— ç¼é›†æˆã€å¯æ‰©å±•æ€§å’Œç®¡ç†ã€‚
Retrievalæ–¹å¼ é’ˆå¯¹ç”¨æˆ·æŸ¥è¯¢ï¼Œæ£€ç´¢æ¨¡å—ä»é¢„å»ºçš„è¯­æ–™åº“ä¸­é€‰æ‹©ä¸æŸ¥è¯¢å’Œæ–‡æ¡£çš„ç›¸ä¼¼åº¦æœ€é«˜çš„å‰kä¸ªç›¸å…³æ–‡æ¡£ã€‚ç„¶åï¼Œç”Ÿæˆæ¨¡å‹ä½¿ç”¨è¿™äº›æ–‡æ¡£æ¥åˆ¶å®šé’ˆå¯¹æŸ¥è¯¢çš„é€‚å½“å“åº”ã€‚ç„¶è€Œï¼ŒåŸå§‹æŸ¥è¯¢ç”±äºè¡¨è¾¾ä¸ä½³å’Œç¼ºä¹è¯­ä¹‰ä¿¡æ¯ï¼Œé€šå¸¸ä¼šè¡¨ç°ä¸ä½³ï¼Œè¿™å¯¹æ£€ç´¢è¿‡ç¨‹äº§ç”Ÿäº†è´Ÿé¢å½±å“ã€‚ä¸ºäº†è§£å†³è¿™äº›é—®é¢˜ï¼Œæˆ‘ä»¬è¯„ä¼°äº†ä¸‰ç§æŸ¥è¯¢è½¬æ¢æ–¹æ³•ï¼Œä½¿ç”¨æ¨èçš„LLM-Embedderä½œä¸ºæŸ¥è¯¢å’Œæ–‡æ¡£ç¼–ç å™¨ï¼š
æŸ¥è¯¢æ”¹å†™ï¼šæŸ¥è¯¢æ”¹å†™é€šè¿‡æ”¹è¿›æŸ¥è¯¢æ¥æ›´å¥½åœ°åŒ¹é…ç›¸å…³æ–‡æ¡£ã€‚å—åˆ°Rewrite-Retrieve-Readæ¡†æ¶çš„å¯å‘ï¼Œæˆ‘ä»¬ä¿ƒä½¿ä¸€ä¸ªLLMé‡å†™æŸ¥è¯¢ä»¥æå‡æ€§èƒ½ã€‚ æŸ¥è¯¢åˆ†è§£ï¼šè¿™ç§æ–¹æ³•æ¶‰åŠåˆ°åŸºäºä»åŸå§‹æŸ¥è¯¢ä¸­æ´¾ç”Ÿçš„å­é—®é¢˜æ¥æ£€ç´¢æ–‡æ¡£ï¼Œè¿™æ¯”ç†è§£å’Œå¤„ç†æ›´å¤æ‚çš„æŸ¥è¯¢è¦å›°éš¾ã€‚ ä¼ªæ–‡æ¡£ç”Ÿæˆï¼šè¿™ç§æ–¹æ³•åŸºäºç”¨æˆ·æŸ¥è¯¢ç”Ÿæˆä¸€ä¸ªå‡æƒ³çš„æ–‡æ¡£ï¼Œå¹¶ä½¿ç”¨å‡æƒ³ç­”æ¡ˆçš„åµŒå…¥æ¥æ£€ç´¢ç›¸ä¼¼æ–‡æ¡£ã€‚ä¸€ä¸ªå€¼å¾—æ³¨æ„çš„å®ç°æ˜¯HyDEã€‚ æœ€è¿‘çš„ç ”ç©¶è¡¨æ˜ç»“åˆåŸºäºè¯æ±‡çš„æœç´¢ä¸å‘é‡æœç´¢å¯ä»¥æ˜¾è‘—æé«˜æ€§èƒ½ã€‚åœ¨æœ¬ç ”ç©¶ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨BM25è¿›è¡Œç¨€ç–æ£€ç´¢å’ŒContrieverï¼Œä¸€ä¸ªæ— ç›‘ç£å¯¹æ¯”ç¼–ç å™¨ï¼Œè¿›è¡Œå¯†é›†æ£€ç´¢ã€‚ Reranking åœ¨æœ€åˆçš„æ£€ç´¢ä¹‹åï¼Œå°†é‡‡ç”¨é‡æ’åºé˜¶æ®µæ¥æé«˜æ£€ç´¢åˆ°çš„æ–‡æ¡£çš„ç›¸å…³æ€§ï¼Œç¡®ä¿æœ€ç›¸å…³çš„ä¿¡æ¯å‡ºç°åœ¨åˆ—è¡¨çš„é¡¶éƒ¨ã€‚è¿™ä¸€é˜¶æ®µé‡‡ç”¨æ›´ç²¾ç¡®ã€è€—æ—¶æ›´é•¿çš„æ–¹æ³•æœ‰æ•ˆåœ°é‡æ–°æ’åºæ–‡æ¡£ï¼Œå¢åŠ æŸ¥è¯¢ä¸æ’åæœ€é«˜çš„æ–‡æ¡£ä¹‹é—´çš„ç›¸ä¼¼åº¦ã€‚
åœ¨æˆ‘ä»¬çš„é‡æ’åºæ¨¡å—ä¸­ï¼Œæˆ‘ä»¬è€ƒè™‘äº†ä¸¤ç§æ–¹æ³•ï¼šDLMé‡æ’åºå’ŒTILDEé‡æ’åºã€‚DLMé‡æ’åºé‡‡ç”¨åˆ†ç±»æ–¹æ³•ï¼Œè€ŒTILDEé‡æ’åºåˆ™ä¾§é‡äºæŸ¥è¯¢å¯èƒ½æ€§ã€‚è¿™äº›æ–¹æ³•åˆ†åˆ«ä¼˜å…ˆè€ƒè™‘æ€§èƒ½å’Œæ•ˆç‡ã€‚
DLMé‡æ’æ–¹æ³•ï¼šè¿™ç§æ–¹æ³•åˆ©ç”¨æ·±åº¦è¯­è¨€æ¨¡å‹ï¼ˆDLMsï¼‰è¿›è¡Œé‡æ’ã€‚è¿™äº›æ¨¡å‹è¢«å¾®è°ƒç”¨ä»¥å°†æ–‡æ¡£ä¸æŸ¥è¯¢çš„ç›¸å…³æ€§åˆ†ç±»ä¸ºâ€œçœŸâ€æˆ–â€œå‡â€ã€‚åœ¨å¾®è°ƒè¿‡ç¨‹ä¸­ï¼Œæ¨¡å‹é€šè¿‡å°†æŸ¥è¯¢å’Œæ–‡æ¡£è¾“å…¥è¿æ¥èµ·æ¥ï¼Œå¹¶æ ¹æ®ç›¸å…³æ€§è¿›è¡Œæ ‡è®°æ¥è¿›è¡Œè®­ç»ƒã€‚åœ¨æ¨ç†æ—¶ï¼Œæ–‡æ¡£æ ¹æ®â€œçœŸâ€æ ‡è®°çš„æ¦‚ç‡è¿›è¡Œæ’åã€‚ TILDEé‡æ’ï¼šTILDEé€šè¿‡é¢„æµ‹æ¨¡å‹è¯æ±‡è¡¨ä¸­çš„å„ä¸ªè¯é¡¹çš„æ¦‚ç‡æ¥ç‹¬ç«‹è®¡ç®—æ¯ä¸ªæŸ¥è¯¢è¯é¡¹çš„å¯èƒ½æ€§ã€‚é€šè¿‡å¯¹æŸ¥è¯¢è¯é¡¹çš„é¢„è®¡ç®—å¯¹æ•°æ¦‚ç‡æ±‚å’Œï¼Œä¸ºæ–‡æ¡£æ‰“åˆ†ï¼Œä»è€Œåœ¨æ¨ç†æ—¶å¿«é€Ÿé‡æ’ã€‚TILDEv2é€šè¿‡ä»…ç´¢å¼•æ–‡æ¡£ä¸­å­˜åœ¨çš„è¯é¡¹ï¼Œä½¿ç”¨NCEæŸå¤±ï¼Œå¹¶æ‰©å±•æ–‡æ¡£ï¼Œä»è€Œæé«˜æ•ˆç‡å¹¶å‡å°ç´¢å¼•å¤§å°ã€‚ æˆ‘ä»¬çš„å®éªŒæ˜¯åœ¨MS MARCO Passageæ’åæ•°æ®é›†ä¸Šè¿›è¡Œçš„ï¼Œè¿™æ˜¯ä¸€ä¸ªå¤§è§„æ¨¡çš„æœºå™¨é˜…è¯»ç†è§£æ•°æ®é›†ã€‚æˆ‘ä»¬éµå¾ªå¹¶å¯¹PyGaggleå’ŒTILDEæä¾›çš„å®ç°è¿›è¡Œäº†ä¿®æ”¹ï¼Œä½¿ç”¨äº†æ¨¡å‹monoT5ã€monoBERTã€RankLLaMAå’ŒTILDEv2ã€‚é‡æ’ç»“æœæ˜¾ç¤ºåœ¨è¡¨ä¸­ã€‚æˆ‘ä»¬æ¨èmonoT5ä½œä¸ºä¸€ç§ç»¼åˆæ€§çš„æ–¹æ³•ï¼Œå¹³è¡¡äº†æ€§èƒ½å’Œæ•ˆç‡ã€‚RankLLaMAé€‚åˆäºå®ç°æœ€ä½³æ€§èƒ½ï¼Œè€ŒTILDEv2æ˜¯åœ¨å›ºå®šé›†åˆä¸Šè·å¾—æœ€å¿«ä½“éªŒçš„ç†æƒ³é€‰æ‹©ã€‚å®éªŒè®¾ç½®å’Œç»“æœçš„è¯¦ç»†ä¿¡æ¯åœ¨é™„å½•ä¸­å‘ˆç°ã€‚ æ–‡æ¡£é‡ç»„ æ–‡æ¡£é‡ç»„åç»­è¿‡ç¨‹çš„è¡¨ç°ï¼Œæ¯”å¦‚LLMå“åº”ç”Ÿæˆï¼Œå¯èƒ½ä¼šå—åˆ°æä¾›æ–‡æ¡£çš„é¡ºåºå½±å“ã€‚ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œåœ¨é‡æ–°æ’åä¹‹åçš„å·¥ä½œæµç¨‹ä¸­ï¼Œæˆ‘ä»¬åŠ å…¥äº†ä¸€ä¸ªç´§å‡‘çš„é‡ç»„æ¨¡å—ï¼ŒåŒ…å«ä¸‰ç§é‡ç»„æ–¹æ³•ï¼šâ€œå‰å‘â€ã€â€œåå‘â€å’Œâ€œä¸¤ä¾§â€ã€‚â€œå‰å‘â€æ–¹æ³•é€šè¿‡é™åºé‡æ–°æ’åé˜¶æ®µçš„ç›¸å…³æ€§å¾—åˆ†æ¥é‡ç»„æ–‡æ¡£ï¼Œè€Œâ€œåå‘â€åˆ™æŒ‰å‡åºæ’åˆ—å®ƒä»¬ã€‚å¯¹äºLLMï¼Œå½“ç›¸å…³ä¿¡æ¯æ”¾åœ¨è¾“å…¥çš„å¤´éƒ¨æˆ–å°¾éƒ¨æ—¶ï¼Œå¯ä»¥è¾¾åˆ°æœ€ä½³æ€§èƒ½ï¼Œæˆ‘ä»¬ä¹ŸåŠ å…¥äº†â€œä¸¤ä¾§â€é€‰é¡¹ã€‚
Reference</p></div><footer class=entry-footer><span title='2024-11-28 07:08:00 +0000 UTC'>November 28, 2024</span>&nbsp;Â·&nbsp;<span>1 min</span>&nbsp;Â·&nbsp;<span>33 words</span>&nbsp;Â·&nbsp;<span>Pan Binghong</span></footer><a class=entry-link aria-label="post link to è®ºæ–‡ç²¾è¯»_å¯»æ‰¾RAGæœ€ä¼˜ç­–ç•¥" href=https://Pan-Binghong.github.io/daily-learning/knowledge/%E8%AE%BA%E6%96%87%E7%B2%BE%E8%AF%BB_%E5%AF%BB%E6%89%BErag%E6%9C%80%E4%BC%98%E7%AD%96%E7%95%A5/></a></article><article class="post-entry tag-entry"><header class=entry-header><h2 class=entry-hint-parent>LlamaIndexæ¥å…¥åƒå¸†RAG</h2></header><div class=entry-content><p>è®°å½•ä»ä½¿ç”¨Llama-indexæ¡†æ¶, åŸºäºåœ¨çº¿æ–‡å¿ƒåƒå¸†å¤§æ¨¡å‹ERNIE-4.0, æ„å»ºå®ç°æœ¬åœ°çŸ¥è¯†æ£€ç´¢.
å¯¼å…¥å¤§æ¨¡å‹ 1 2 from llama_index.llms.qianfan import Qianfan access_key = ""secret_key = ""model_name = "ERNIE-4.0-8K-Latest"url = "https://aip.baidubce.com/rpc/2.0/ai_custom/v1/wenxinworkshop/chat/completions_pro"llm = Qianfan(access_key, secret_key, model_name, url, context_window=8192) model_nameå¯åœ¨åƒå¸†å¹³å°æŸ¥çœ‹, å¦‚ä¸‹å›¾:
å¯¼å…¥æœ¬åœ°Embedding ä¸‹è½½Embeddingæ¨¡å‹ 1 2 from modelscope import snapshot_download model_dir = snapshot_download('Xorbits/bge-m3', cache_dir='/data/LLMs') åŠ è½½æœ¬åœ°Embeddingæ¨¡å‹ 1 2 from llama_index.embeddings.huggingface import HuggingFaceEmbedding cache_folder = r"embed_model/m3e-large"embed_model = HuggingFaceEmbedding(cache_folder=cache_folder) æ„å»ºæœ¬åœ°çŸ¥è¯†åº“ 1 2 from llama_index.core import SimpleDirectoryReader, VectorStoreIndex directory = "/data/documents" #æ–‡æ¡£è·¯å¾„vector_index = VectorStoreIndex.from_documents(documents) æ„å»ºæŸ¥è¯¢å¼•æ“ 1 query_engine = vector_index.as_query_engine(similarity_top_k=3, llm=llm) similarity_top_kå¯æ ¹æ®ç»éªŒè‡ªè¡Œè°ƒæ•´, æ¨èè®¾ç½®3, 5.
æ„å»ºRAG Agent æ„å»ºå·¥å…· 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 import os def get_tool(name, full_name, documents=None): if not os.path.exists(f"./data/{name}"): # build vector index vector_index = VectorStoreIndex.from_documents(documents) vector_index.storage_context.persist(persist_dir=f"./data/{name}") else: vector_index = load_index_from_storage( StorageContext.from_defaults(persist_dir=f"./data/{name}"), ) query_engine = vector_index.as_query_engine(similarity_top_k=3, llm=llm) query_engine_tool = QueryEngineTool( query_engine=query_engine, metadata=ToolMetadata( name=name, description=( "Provides information about Uber quarterly financials ending" f" {full_name}" ), ), ) return query_engine_tool è®¾ç½®Agent 1 2 3 from llama_index.core.agent import AgentRunner, ReActAgent agent = ReActAgent.from_tools( query_engine_tools, llm=agent_llm, verbose=True, max_iterations=20) è¿è¡Œ 1 response = agent.chat("æ‚¨çš„é—®é¢˜") æ•´ä½“ä»£ç  1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 from llama_index.core import Settings import os from llama_index.core import SimpleDirectoryReader, VectorStoreIndex from llama_index.llms.qianfan import Qianfan from llama_index.core.tools import QueryEngineTool, ToolMetadata from llama_index.embeddings.huggingface import HuggingFaceEmbedding # åˆå§‹åŒ–Qianfanæ¨¡å‹class Rag: def __init__(self): self.access_key = "" self.secret_key = "" self.model_name = "ERNIE-4.0-8K-Latest" self.url = "https://aip.baidubce.com/rpc/2.0/ai_custom/v1/wenxinworkshop/chat/completions_pro" self.llm = Qianfan(self.access_key, self.secret_key, self.model_name, self.url, context_window=8192) self.cache_folder = r"embed_model/m3e-large" self.directory = r"/data/documents" # æ•°æ®ç›®å½•è·¯å¾„ def get_tool(self, name, full_name, documents=None): embed_model = HuggingFaceEmbedding(cache_folder=self.cache_folder) Settings.embed_model = embed_model vector_index = VectorStoreIndex.from_documents(documents) persist_path = f"{self.directory}/{name}" if not os.path.exists(persist_path): vector_index.storage_context.persist(persist_dir=persist_path) query_engine = vector_index.as_query_engine(similarity_top_k=3, llm=self.llm) query_engine_tool = QueryEngineTool(query_engine=query_engine, metadata=ToolMetadata(name=name, description=f"Provides information from document {full_name}")) return query_engine_tool def parse_args(self): query_engine_tools = [] for filename in os.listdir(self.directory): if filename.endswith(".txt"): filepath = os.path.join(self.directory, filename) documents = SimpleDirectoryReader(input_files=[filepath]).load_data() tool_name = filename[:-4] # å»é™¤'.txt'å¾—åˆ°å·¥å…·åç§° tool = self.get_tool(tool_name, tool_name, documents=documents) query_engine_tools.append(tool) return query_engine_tools def query_engine(self, query): from llama_index.core.agent import ReActAgent tools = self.parse_args() agent = ReActAgent.from_tools(tools, llm=self.llm, verbose=True, max_iterations=20) response = agent.chat(query) return response # åˆ›å»º Rag å®ä¾‹å¹¶æ‰§è¡ŒæŸ¥è¯¢if __name__ == "__main__": rag = Rag() print(rag.query_engine(query="é—®é¢˜")) å‚è€ƒé“¾æ¥
...</p></div><footer class=entry-footer><span title='2024-10-29 01:52:00 +0000 UTC'>October 29, 2024</span>&nbsp;Â·&nbsp;<span>2 min</span>&nbsp;Â·&nbsp;<span>358 words</span>&nbsp;Â·&nbsp;<span>Pan Binghong</span></footer><a class=entry-link aria-label="post link to LlamaIndexæ¥å…¥åƒå¸†RAG" href=https://Pan-Binghong.github.io/daily-learning/ai/llamaindex%E6%8E%A5%E5%85%A5%E5%8D%83%E5%B8%86rag/></a></article></main><footer class=footer><span>&copy; 2026 <a href=https://Pan-Binghong.github.io/daily-learning/>Pan Binghong's Tech Blog</a></span> Â·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
<a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentColor"><path d="M12 6H0l6-6z"/></svg></a><div class=reading-progress-bar id=reading-progress></div><script>window.addEventListener("scroll",function(){const e=document.getElementById("reading-progress");if(!e)return;const t=window.innerHeight,n=document.documentElement.scrollHeight-t,s=window.scrollY,o=s/n*100;e.style.width=o+"%"}),document.addEventListener("DOMContentLoaded",function(){const e=document.querySelectorAll(".copy-text");e.forEach(e=>{e.addEventListener("click",function(){this.textContent="âœ“ å·²å¤åˆ¶",setTimeout(()=>{this.textContent="å¤åˆ¶"},2e3)})})}),document.addEventListener("DOMContentLoaded",function(){const e=document.querySelectorAll('a[href^="http"]');e.forEach(e=>{e.hostname!==window.location.hostname&&(e.setAttribute("target","_blank"),e.setAttribute("rel","noopener noreferrer"))})}),document.addEventListener("DOMContentLoaded",function(){const e=document.querySelectorAll(".post-content img");e.forEach(e=>{e.style.cursor="pointer",e.addEventListener("click",function(){window.open(this.src,"_blank")})})})</script><style>#top-link{transition:all .3s ease}#top-link:hover{transform:translateY(-5px);box-shadow:0 5px 15px rgba(0,0,0,.2)}</style><script>let menu=document.getElementById("menu");if(menu){const e=localStorage.getItem("menu-scroll-position");e&&(menu.scrollLeft=parseInt(e,10)),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}}document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{const e=document.querySelector("html");e.dataset.theme==="dark"?(e.dataset.theme="light",localStorage.setItem("pref-theme","light")):(e.dataset.theme="dark",localStorage.setItem("pref-theme","dark"))})</script></body></html>